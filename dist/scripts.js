var repository=function(){var t=[],n="https://rickandmortyapi.com/api/character/?page=1";$(".modal");function a(t){var n=$(".rickopedia-list"),a=$("<li></li>");n.append(a);var e=$('<button class="btn btn-dark col-lg-8 col-sm button--li" data-toggle="modal" data-target="#modal-container">'+t.name+"</button>");a.append(e),e.on("click",function(n){var a;r(a=t).then(function(){i(a)})})}function e(n){"object"==typeof n&&t.push(n)}function o(t){var n=[];return $.each(t,function(a){var o={name:t[a].name,detailsUrl:t[a].url};e(o),n.push(o),console.log("getCharacters",o)}),n}function r(t){var n=t.detailsUrl;return $.ajax(n).then(function(n){return t.imageUrl=n.image,t.name=n.name,t.type=n.type,t.status=n.status,t.gender=n.gender,t.species=n.species,t.origin=n.origin.name,t}).catch(function(t){console.error(t)})}function i(t){$(".modal-title").text(t.name);var n=$(".modal-body");n.empty();var a=$('<img class="character-image img-fluid"></img>');a.attr("src",t.imageUrl),n.append(a);var e=$("<p>Species: "+t.species+"</p>");if(n.append(e),t.type){var o=$("<p>Type: "+t.type+"</p>");n.append(o)}var r=$("<p>Gender: "+t.gender+"</p>");n.append(r);var i=$("<p>Origin: "+t.origin+"</p>");if(n.append(i),t.status){var c=$("<p>Status: "+t.status+"</p>");n.append(c)}}return{add:e,getAll:function(){return t},addListItem:a,loadList:function(t){return t||(t=n),$.ajax(t,{dataType:"json"}).then(function(t){var n=t.info.next;o(t.results),jQuery(function(t){t("#rickopedia-scroll").on("scroll",function(){if(Math.ceil(t(this).scrollTop())+t(this).innerHeight()>=t(this)[0].scrollHeight&&n)return t("#loading").show(),t.ajax(n,{dataType:"json"}).then(function(t){n=t.info.next,o(t.results).forEach(function(t){a(t)})})})})})},loadDetails:r,showModal:i}}();repository.loadList().then(function(){repository.getAll().forEach(function(t){repository.addListItem(t)})});var $toTop=$(".to-top");$toTop.on("click",function(){$("#rickopedia-scroll").scrollTop(0)});
